Ok, aqui vai a an√°lise do portal + o sistema completo de coleta. O portal de Rio Branco √© JSF puro ‚Äî sem API REST. Os dados t√™m que ser extra√≠dos via form POST com ViewState, que √© exatamente o que o `jsf_client.py` do repo j√° tenta fazer.

Vou escrever o engine de coleta multi-fonte completo:O ZIP cont√©m tudo. Deixa eu te explicar o que foi entregue e como montar:

---

## Estrutura do que est√° no ZIP

```
sources_registry.py      ‚Üí cat√°logo de todas as 20 fontes configuradas
engine.py               ‚Üí motor universal de coleta (REST/CSV/QD/SICONFI)
riobranco_jsf_v2.py     ‚Üí scraper do portal JSF de Rio Branco (engenharia reversa)
cnpj_enricher.py        ‚Üí enriquecimento CNPJ + detec√ß√£o de s√≥cios
cross_reference_engine.py ‚Üí 8 detectores de anomalias com base legal
run_full_pipeline.sh    ‚Üí script √∫nico que roda tudo em sequ√™ncia
requirements.txt        ‚Üí deps atualizadas
```

---

## Sequ√™ncia para integrar no repo existente

```bash
# Instalar novos deps
pip install httpx rich rapidfuzz --break-system-packages

# Copiar os arquivos para o repo
cp sources_registry.py src/ingest/
cp engine.py src/ingest/
cp riobranco_jsf_v2.py src/ingest/
cp cnpj_enricher.py src/ingest/
cp cross_reference_engine.py src/core/
cp run_full_pipeline.sh .
chmod +x run_full_pipeline.sh

# Rodar s√≥ o que j√° tem dados (portal JSF)
python -m src.ingest.riobranco_jsf_v2 --endpoint diaria
python -m src.ingest.riobranco_jsf_v2 --endpoint obra

# Rodar fontes REST (gratuitas, sem JSF)
python -m src.ingest.engine --source pncp_contratos   # contratos federais em RB
python -m src.ingest.engine --source tse_doacoes      # CR√çTICO: doa√ß√µes 2024
python -m src.ingest.engine --source cgu_ceis         # empresas suspensas
python -m src.ingest.engine --source qd_diario_rb     # D.O. OCR-izado

# Depois dos dados: enriquecer CNPJs e cruzar
python -m src.ingest.cnpj_enricher
python -m src.core.cross_reference_engine
```

---

## Sobre o portal JSF de Rio Branco

O `riobranco_jsf_v2.py` tenta 3 estrat√©gias em ordem:
1. **Export CSV via bot√£o** ‚Äî se o PrimeFaces tiver `p:dataExporter`, sai direto como arquivo
2. **Pagina√ß√£o AJAX** ‚Äî simula clique "pr√≥xima p√°gina" via POST com ViewState
3. **Parse HTML est√°tico** ‚Äî √∫ltima op√ß√£o, s√≥ a primeira p√°gina

**Se tudo falhar** (o JSF pode ter anti-scraping), o script te diz exatamente o que fazer com o DevTools. Mas o `jsf_client.py` que voc√™ j√° tem no repo provavelmente j√° tem esse fluxo funcionando ‚Äî o `riobranco_jsf_v2.py` √© uma vers√£o mais gen√©rica e autodescobridora.

---

## Fontes mais valiosas para cruzamento (em ordem)

| Prioridade | Fonte | Por que |
|---|---|---|
| üî¥ 1 | TSE Doa√ß√µes 2024 | Liga dinheiro eleitoral ‚Üí contrato |
| üî¥ 1 | CGU CEIS/CNEP | Empresa suspensa com contrato ativo = crime |
| üî¥ 1 | PNCP contratos | API REST limpa, sem JSF, dados federais em RB |
| üî¥ 1 | BrasilAPI CNPJ | QSA dos s√≥cios para cruzar nepotismo |
| üü° 2 | Querido Di√°rio | Portaria de di√°ria no D.O. ‚Äî valida ou derruba viagem |
| üü° 2 | SICONFI | RCL para calcular se LRF est√° estourado |

Sobre a preocupa√ß√£o do Bruno com repres√°lias: o projeto √© literalmente dados p√∫blicos + an√°lise estat√≠stica. Isso √© jornalismo de dados, n√£o invas√£o. A `lei 12.527/11 (LAI)` protege o acesso. O aviso legal que j√° est√° no app √© suficiente.